<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_162) on Sat Feb 02 18:57:35 CET 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>HttpExternalImageProvider (Communote 3.5 API)</title>
<meta name="date" content="2019-02-02">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="HttpExternalImageProvider (Communote 3.5 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":6,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":6,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10,"i29":10,"i30":10,"i31":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HttpExternalImageProvider.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/communote/server/core/image/FileSystemCachingImageManager.html" title="class in com.communote.server.core.image"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/communote/server/core/image/ImageProviderManager.html" title="class in com.communote.server.core.image"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/communote/server/core/image/HttpExternalImageProvider.html" target="_top">Frames</a></li>
<li><a href="HttpExternalImageProvider.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.communote.server.core.image</div>
<h2 title="Class HttpExternalImageProvider" class="title">Class HttpExternalImageProvider&lt;C&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">com.communote.server.api.core.image.ImageProvider</a></li>
<li>
<ul class="inheritance">
<li>com.communote.server.core.image.HttpExternalImageProvider&lt;C&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>C</code> - the type of the configuration class</dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../com/communote/server/core/image/type/HttpExternalUserImageProvider.html" title="class in com.communote.server.core.image.type">HttpExternalUserImageProvider</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">HttpExternalImageProvider&lt;C&gt;</span>
extends <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></pre>
<div class="block">Image provider which loads images from an external system using HTTP GET requests.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Communote GmbH - <a href="http://www.communote.com/">http://www.communote.com/</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#HttpExternalImageProvider-java.lang.String-java.lang.String-long-">HttpExternalImageProvider</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identifier,
                         <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;pathToDefaultImage,
                         long&nbsp;disablingDuration)</code>
<div class="block">Create a new external image provider</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#assertNotDisabled-java.lang.String-C-">assertNotDisabled</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Test that the image provider was not disabled.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#cleanup--">cleanup</a></span>()</code>
<div class="block">Cleanup held resources.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#disableTemporarily-java.lang.String-C-">disableTemporarily</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;reason,
                  <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Temporarily disable the image provider</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#enable--">enable</a></span>()</code>
<div class="block">Re-enable the provider if it is currently temporarily disabled.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../com/communote/server/api/core/image/ByteArrayImage.html" title="class in com.communote.server.api.core.image">ByteArrayImage</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#extractImageFromEntity-org.apache.http.HttpEntity-java.util.Date-">extractImageFromEntity</a></span>(org.apache.http.HttpEntity&nbsp;entity,
                      <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a>&nbsp;imageLastModified)</code>
<div class="block">Extract the image from the response entity.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected abstract <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getConfiguration--">getConfiguration</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getConnectionManagerTimeout--">getConnectionManagerTimeout</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getConnectionTimeout--">getConnectionTimeout</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getDefaultImageVersionString--">getDefaultImageVersionString</a></span>()</code>
<div class="block">The version string of the default image.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected org.apache.http.client.config.RequestConfig</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getDefaultRequestConfig--">getDefaultRequestConfig</a></span>()</code>
<div class="block">Prepare and return a request configuration that is used as default for all requests started
 by the shared HttpClient instance.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getDisabledUntilTimestamp--">getDisabledUntilTimestamp</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>protected org.apache.http.impl.client.CloseableHttpClient</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getHttpClient--">getHttpClient</a></span>()</code>
<div class="block">Get the HTTP client to be used for all requests.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>protected abstract <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getImageURL-java.lang.String-C-">getImageURL</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
           <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Get the URL under which the image with the given identifier can be downloaded</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getLastModifiedHeaderValue-org.apache.http.client.methods.CloseableHttpResponse-">getLastModifiedHeaderValue</a></span>(org.apache.http.client.methods.CloseableHttpResponse&nbsp;response)</code>
<div class="block">Get last modified header value as date, will fall back to current time if header is not set</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getNotDisablingStatusCodes--">getNotDisablingStatusCodes</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>protected org.apache.http.protocol.HttpContext</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getRequestContext-java.net.URI-java.lang.String-C-">getRequestContext</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&nbsp;imageUrl,
                 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Get request context to be used when downloading the given image.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>protected <a href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.http.Header&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getRequestHeaders-java.net.URI-java.lang.String-C-">getRequestHeaders</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&nbsp;imageUrl,
                 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Get the HTTP request headers to add when downloading the given image.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getSocketTimeout--">getSocketTimeout</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#hasDefaultImage-java.lang.String-">hasDefaultImage</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)</code>
<div class="block">Return whether the provider has a default image for the case when there is no image for a
 given identifier.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#imageNotDownloaded-java.lang.String-">imageNotDownloaded</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)</code>
<div class="block">Invoked when the image URL was null or the image could not be downloaded and the cause was
 not one that would disable the provider.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#imageSuccessfullyDownloaded-java.lang.String-java.util.Date-org.apache.http.client.methods.CloseableHttpResponse-">imageSuccessfullyDownloaded</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                           <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a>&nbsp;lastModificationDate,
                           org.apache.http.client.methods.CloseableHttpResponse&nbsp;response)</code>
<div class="block">Invoked by loadImage after successfully parsing and extracting the image.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#isDisabled-C-">isDisabled</a></span>(<a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</code>
<div class="block">Test whether the image provider was temporarily disabled.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#isDisablingException-java.io.IOException-">isDisablingException</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>&nbsp;e)</code>
<div class="block">Determines if a caught IO exception is one which should disable the image provider
 temporarily.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#isExternalProvider--">isExternalProvider</a></span>()</code>
<div class="block">Return whether this provider loads image from an external resource (like another server) and
 not from the local database or file system.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#isProvideDefaultImageIfDisabled--">isProvideDefaultImageIfDisabled</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/communote/server/api/core/image/Image.html" title="class in com.communote.server.api.core.image">Image</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#loadDefaultImage--">loadDefaultImage</a></span>()</code>
<div class="block">Load the default image.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code><a href="../../../../../com/communote/server/api/core/image/Image.html" title="class in com.communote.server.api.core.image">Image</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#loadImage-java.lang.String-">loadImage</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)</code>
<div class="block">Load the unscaled image</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>protected org.apache.http.impl.client.CloseableHttpClient</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#prepareHttpClient-org.apache.http.impl.client.HttpClientBuilder-">prepareHttpClient</a></span>(org.apache.http.impl.client.HttpClientBuilder&nbsp;builder)</code>
<div class="block">Prepare the HTTP client that should be used by all requests.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#setHttpClient-org.apache.http.impl.client.CloseableHttpClient-boolean-">setHttpClient</a></span>(org.apache.http.impl.client.CloseableHttpClient&nbsp;httpClient,
             boolean&nbsp;replace)</code>
<div class="block">Set the HTTP client instance that should be used for all requests.</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#setProvideDefaultImageIfDisabled-boolean-">setProvideDefaultImageIfDisabled</a></span>(boolean&nbsp;provideDefaultImageIfDisabled)</code>
<div class="block">Set whether the default image can be returned even if the provider is temporarily disabled.</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#validateContentType-java.lang.String-">validateContentType</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;contentType)</code>
<div class="block">Validate that the content type of the response is an image mime type.</div>
</td>
</tr>
<tr id="i31" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#validateStatusCode-org.apache.http.StatusLine-">validateStatusCode</a></span>(org.apache.http.StatusLine&nbsp;statusLine)</code>
<div class="block">Checks the status code of a response for an image request.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.communote.server.api.core.image.ImageProvider">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.communote.server.api.core.image.<a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></h3>
<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#canLoad-java.lang.String-">canLoad</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getDefaultImageMimeType--">getDefaultImageMimeType</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getDefaultImageResourceLastModificationTimestamp--">getDefaultImageResourceLastModificationTimestamp</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getIdentifier--">getIdentifier</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getTimeToLive--">getTimeToLive</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getVersionString-java.lang.String-">getVersionString</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#imageChanged-java.lang.String-">imageChanged</a>, <a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#isAuthorized-java.lang.String-">isAuthorized</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="HttpExternalImageProvider-java.lang.String-java.lang.String-long-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HttpExternalImageProvider</h4>
<pre>public&nbsp;HttpExternalImageProvider(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identifier,
                                 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;pathToDefaultImage,
                                 long&nbsp;disablingDuration)</pre>
<div class="block">Create a new external image provider</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>identifier</code> - The identifier of the provider. The identifier has to be unique among all
            providers that are registered for an image type.</dd>
<dd><code>pathToDefaultImage</code> - If the path starts with file: it is interpreted as a file URI otherwise it is
            interpreted as the name of a resource containing the default image. This resource
            will be loaded with the class loader of this class. If null, there will be no
            default image.</dd>
<dd><code>disablingDuration</code> - the amount of milliseconds to disable the image provider temporarily in certain
            situations e.g. if the external server is unreachable. If 0 or less the provider
            is never disabled.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="assertNotDisabled-java.lang.String-java.lang.Object-">
<!--   -->
</a><a name="assertNotDisabled-java.lang.String-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertNotDisabled</h4>
<pre>protected&nbsp;void&nbsp;assertNotDisabled(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                                 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)
                          throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></pre>
<div class="block">Test that the image provider was not disabled. This method is called from loadImage and
 implementations should also invoke it from other methods that return image data or
 information (default image, version string).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - the Id of the image that should be loaded. Only needed to create a useful
            exception.</dd>
<dd><code>configuration</code> - the current configuration of the image provider, can be null. Default
            implementation ignores this parameter.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageTemporarilyNotFoundException.html" title="class in com.communote.server.api.core.image">ImageTemporarilyNotFoundException</a></code> - in case the provider is disabled and the provided image can thus not be loaded</dd>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code></dd>
</dl>
</li>
</ul>
<a name="cleanup--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanup</h4>
<pre>public&nbsp;void&nbsp;cleanup()</pre>
<div class="block">Cleanup held resources. Should be called when the provider is unregistered.</div>
</li>
</ul>
<a name="disableTemporarily-java.lang.String-java.lang.Object-">
<!--   -->
</a><a name="disableTemporarily-java.lang.String-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>disableTemporarily</h4>
<pre>protected&nbsp;void&nbsp;disableTemporarily(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;reason,
                                  <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</pre>
<div class="block">Temporarily disable the image provider</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reason</code> - The reason that caused the disabling of the provider</dd>
<dd><code>configuration</code> - the current configuration of the image provider, can be null. Default
            implementation ignores this parameter.</dd>
</dl>
</li>
</ul>
<a name="enable--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enable</h4>
<pre>protected&nbsp;void&nbsp;enable()</pre>
<div class="block">Re-enable the provider if it is currently temporarily disabled.</div>
</li>
</ul>
<a name="extractImageFromEntity-org.apache.http.HttpEntity-java.util.Date-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>extractImageFromEntity</h4>
<pre>protected&nbsp;<a href="../../../../../com/communote/server/api/core/image/ByteArrayImage.html" title="class in com.communote.server.api.core.image">ByteArrayImage</a>&nbsp;extractImageFromEntity(org.apache.http.HttpEntity&nbsp;entity,
                                                <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a>&nbsp;imageLastModified)
                                         throws <a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a>,
                                                <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></pre>
<div class="block">Extract the image from the response entity. The caller has to take care of closing the
 response or ensuring that the entity is consumed.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>entity</code> - the entity to handle</dd>
<dd><code>imageLastModified</code> - the date of the last modification of the image contained in the entity. This could
            for instance be the value of the Last-Modified header.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the image</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a></code> - in case <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#validateContentType-java.lang.String-"><code>validateContentType(String)</code></a> threw this exception</dd>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - in case the entity is not a valid image</dd>
</dl>
</li>
</ul>
<a name="getConfiguration--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConfiguration</h4>
<pre>protected abstract&nbsp;<a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;getConfiguration()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current configuration of the external image provider. During loadImage the same
         configuration object is passed to all called methods.</dd>
</dl>
</li>
</ul>
<a name="getConnectionManagerTimeout--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnectionManagerTimeout</h4>
<pre>protected&nbsp;int&nbsp;getConnectionManagerTimeout()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>timeout in milliseconds to wait for a connection from the connection manager of the
         HttpClient. Can be 0 for an infinite timeout. Defaults to 30s.</dd>
</dl>
</li>
</ul>
<a name="getConnectionTimeout--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnectionTimeout</h4>
<pre>protected&nbsp;int&nbsp;getConnectionTimeout()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>timeout in milliseconds to wait until a connection to the remote host must have been
         established. Can be 0 for an infinite timeout. Defaults to 30s.</dd>
</dl>
</li>
</ul>
<a name="getDefaultImageVersionString--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefaultImageVersionString</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getDefaultImageVersionString()
                                    throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getDefaultImageVersionString--">ImageProvider</a></code></span></div>
<div class="block">The version string of the default image.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getDefaultImageVersionString--">getDefaultImageVersionString</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the version string</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - in case there is no default image</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#getVersionString-java.lang.String-"><code>ImageProvider.getVersionString(String)</code></a></dd>
</dl>
</li>
</ul>
<a name="getDefaultRequestConfig--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefaultRequestConfig</h4>
<pre>protected&nbsp;org.apache.http.client.config.RequestConfig&nbsp;getDefaultRequestConfig()</pre>
<div class="block">Prepare and return a request configuration that is used as default for all requests started
 by the shared HttpClient instance. The default implementation will set the socket, connection
 and connection manager timeouts to the values returned by <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getSocketTimeout--"><code>getSocketTimeout()</code></a>,
 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getConnectionTimeout--"><code>getConnectionTimeout()</code></a> and <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getConnectionManagerTimeout--"><code>getConnectionManagerTimeout()</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the default request configuration</dd>
</dl>
</li>
</ul>
<a name="getDisabledUntilTimestamp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDisabledUntilTimestamp</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&nbsp;getDisabledUntilTimestamp()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the epoch timestamp in milliseconds until the provider is currently disabled, or null
         if not disabled</dd>
</dl>
</li>
</ul>
<a name="getHttpClient--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHttpClient</h4>
<pre>protected&nbsp;org.apache.http.impl.client.CloseableHttpClient&nbsp;getHttpClient()</pre>
<div class="block">Get the HTTP client to be used for all requests. If there is no current HTTP client a new one
 will be created and prepared with a call to <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#prepareHttpClient-org.apache.http.impl.client.HttpClientBuilder-"><code>prepareHttpClient(HttpClientBuilder)</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current HTTP client</dd>
</dl>
</li>
</ul>
<a name="getImageURL-java.lang.String-java.lang.Object-">
<!--   -->
</a><a name="getImageURL-java.lang.String-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getImageURL</h4>
<pre>protected abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getImageURL(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                                      <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)
                               throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></pre>
<div class="block">Get the URL under which the image with the given identifier can be downloaded</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - the ID of the image to download</dd>
<dd><code>configuration</code> - the configuration of the image provider, can be null</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the URL to the image. If null is returned the load method will throw an
         ImageNotFoundException</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - can be thrown to indicate that image does not exist image</dd>
</dl>
</li>
</ul>
<a name="getLastModifiedHeaderValue-org.apache.http.client.methods.CloseableHttpResponse-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastModifiedHeaderValue</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a>&nbsp;getLastModifiedHeaderValue(org.apache.http.client.methods.CloseableHttpResponse&nbsp;response)</pre>
<div class="block">Get last modified header value as date, will fall back to current time if header is not set</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>response</code> - the response of the image request</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the last modification date</dd>
</dl>
</li>
</ul>
<a name="getNotDisablingStatusCodes--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNotDisablingStatusCodes</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;getNotDisablingStatusCodes()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the status codes which should not lead to disabling the image provider temporarily.
         The code 200 does not need to be in the result.</dd>
</dl>
</li>
</ul>
<a name="getRequestContext-java.net.URI-java.lang.String-java.lang.Object-">
<!--   -->
</a><a name="getRequestContext-java.net.URI-java.lang.String-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRequestContext</h4>
<pre>protected&nbsp;org.apache.http.protocol.HttpContext&nbsp;getRequestContext(<a href="http://docs.oracle.com/javase/8/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&nbsp;imageUrl,
                                                                 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                                                                 <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</pre>
<div class="block">Get request context to be used when downloading the given image. Implementations could use
 this method to provide authentication details. The default implementation returns null.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageUrl</code> - the URL pointing to the image</dd>
<dd><code>imageIdentifier</code> - the ID of the image to get</dd>
<dd><code>configuration</code> - the configuration of the image provider, can be null</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the request context</dd>
</dl>
</li>
</ul>
<a name="getRequestHeaders-java.net.URI-java.lang.String-java.lang.Object-">
<!--   -->
</a><a name="getRequestHeaders-java.net.URI-java.lang.String-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRequestHeaders</h4>
<pre>protected&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.http.Header&gt;&nbsp;getRequestHeaders(<a href="http://docs.oracle.com/javase/8/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&nbsp;imageUrl,
                                                         <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                                                         <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</pre>
<div class="block">Get the HTTP request headers to add when downloading the given image. The default
 implementation returns null.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageUrl</code> - the URL pointing to the image</dd>
<dd><code>imageIdentifier</code> - the ID of the image to get</dd>
<dd><code>configuration</code> - the configuration of the image provider, can be null</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the headers</dd>
</dl>
</li>
</ul>
<a name="getSocketTimeout--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSocketTimeout</h4>
<pre>protected&nbsp;int&nbsp;getSocketTimeout()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>timeout in milliseconds to wait for data after a connection was established. Can be 0
         for an infinite timeout. Defaults to 30s.</dd>
</dl>
</li>
</ul>
<a name="hasDefaultImage-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasDefaultImage</h4>
<pre>public&nbsp;boolean&nbsp;hasDefaultImage(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#hasDefaultImage-java.lang.String-">ImageProvider</a></code></span></div>
<div class="block">Return whether the provider has a default image for the case when there is no image for a
 given identifier.

 This implementation will return true if the resource identified by the constructor parameter
 pathToDefaultImage exists.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#hasDefaultImage-java.lang.String-">hasDefaultImage</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - the identifier for which no image was found</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>whether there is a default image</dd>
</dl>
</li>
</ul>
<a name="imageNotDownloaded-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>imageNotDownloaded</h4>
<pre>protected&nbsp;void&nbsp;imageNotDownloaded(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)</pre>
<div class="block">Invoked when the image URL was null or the image could not be downloaded and the cause was
 not one that would disable the provider. Default implementation does nothing but subclasses
 could use this method to update or reset the version string of the image if necessary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - the ID of the image that failed</dd>
</dl>
</li>
</ul>
<a name="imageSuccessfullyDownloaded-java.lang.String-java.util.Date-org.apache.http.client.methods.CloseableHttpResponse-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>imageSuccessfullyDownloaded</h4>
<pre>protected&nbsp;void&nbsp;imageSuccessfullyDownloaded(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier,
                                           <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Date.html?is-external=true" title="class or interface in java.util">Date</a>&nbsp;lastModificationDate,
                                           org.apache.http.client.methods.CloseableHttpResponse&nbsp;response)</pre>
<div class="block">Invoked by loadImage after successfully parsing and extracting the image. Default
 implementation does nothing but subclasses could use this method to update the version string
 of the image if necessary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - the ID of the image</dd>
<dd><code>lastModificationDate</code> - the last modification date of the as returned by
            <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getLastModifiedHeaderValue-org.apache.http.client.methods.CloseableHttpResponse-"><code>getLastModifiedHeaderValue(CloseableHttpResponse)</code></a></dd>
<dd><code>response</code> - the response that contained the image</dd>
</dl>
</li>
</ul>
<a name="isDisabled-java.lang.Object-">
<!--   -->
</a><a name="isDisabled-C-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDisabled</h4>
<pre>protected&nbsp;boolean&nbsp;isDisabled(<a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html" title="type parameter in HttpExternalImageProvider">C</a>&nbsp;configuration)</pre>
<div class="block">Test whether the image provider was temporarily disabled.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>configuration</code> - the current configuration of the image provider, can be null. Default
            implementation ignores this parameter.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the provider was disabled</dd>
</dl>
</li>
</ul>
<a name="isDisablingException-java.io.IOException-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDisablingException</h4>
<pre>protected&nbsp;boolean&nbsp;isDisablingException(<a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>&nbsp;e)</pre>
<div class="block">Determines if a caught IO exception is one which should disable the image provider
 temporarily. By default the exceptions <code>ConnectTimeoutException</code>,
 <a href="http://docs.oracle.com/javase/8/docs/api/java/net/SocketTimeoutException.html?is-external=true" title="class or interface in java.net"><code>SocketTimeoutException</code></a> and <a href="http://docs.oracle.com/javase/8/docs/api/java/net/SocketException.html?is-external=true" title="class or interface in java.net"><code>SocketException</code></a> are considered as disabling
 exceptions.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>e</code> - the exception to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the image provider should be disabled</dd>
</dl>
</li>
</ul>
<a name="isExternalProvider--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isExternalProvider</h4>
<pre>public&nbsp;boolean&nbsp;isExternalProvider()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#isExternalProvider--">ImageProvider</a></code></span></div>
<div class="block">Return whether this provider loads image from an external resource (like another server) and
 not from the local database or file system.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#isExternalProvider--">isExternalProvider</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true, if it is a provider for external images</dd>
</dl>
</li>
</ul>
<a name="isProvideDefaultImageIfDisabled--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isProvideDefaultImageIfDisabled</h4>
<pre>public&nbsp;boolean&nbsp;isProvideDefaultImageIfDisabled()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>whether to return the default image even if the provider is temporarily disabled.
         Defaults to false.</dd>
</dl>
</li>
</ul>
<a name="loadDefaultImage--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadDefaultImage</h4>
<pre>public&nbsp;<a href="../../../../../com/communote/server/api/core/image/Image.html" title="class in com.communote.server.api.core.image">Image</a>&nbsp;loadDefaultImage()
                       throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#loadDefaultImage--">ImageProvider</a></code></span></div>
<div class="block">Load the default image.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#loadDefaultImage--">loadDefaultImage</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the default image</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - in case there is no default image.</dd>
</dl>
</li>
</ul>
<a name="loadImage-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadImage</h4>
<pre>public&nbsp;<a href="../../../../../com/communote/server/api/core/image/Image.html" title="class in com.communote.server.api.core.image">Image</a>&nbsp;loadImage(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;imageIdentifier)
                throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a>,
                       <a href="../../../../../com/communote/server/api/core/security/AuthorizationException.html" title="class in com.communote.server.api.core.security">AuthorizationException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#loadImage-java.lang.String-">ImageProvider</a></code></span></div>
<div class="block">Load the unscaled image</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html#loadImage-java.lang.String-">loadImage</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../com/communote/server/api/core/image/ImageProvider.html" title="class in com.communote.server.api.core.image">ImageProvider</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>imageIdentifier</code> - The identifier of the image</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The image.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - in case there is no image for the imageIdentifier or loading failed</dd>
<dd><code><a href="../../../../../com/communote/server/api/core/security/AuthorizationException.html" title="class in com.communote.server.api.core.security">AuthorizationException</a></code> - in case the current user is not allowed to access the image</dd>
</dl>
</li>
</ul>
<a name="prepareHttpClient-org.apache.http.impl.client.HttpClientBuilder-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareHttpClient</h4>
<pre>protected&nbsp;org.apache.http.impl.client.CloseableHttpClient&nbsp;prepareHttpClient(org.apache.http.impl.client.HttpClientBuilder&nbsp;builder)</pre>
<div class="block">Prepare the HTTP client that should be used by all requests. The default implementations sets
 the request config as returned by <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getDefaultRequestConfig--"><code>getDefaultRequestConfig()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>builder</code> - the HTTP client builder</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the HTTP client</dd>
</dl>
</li>
</ul>
<a name="setHttpClient-org.apache.http.impl.client.CloseableHttpClient-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setHttpClient</h4>
<pre>protected&nbsp;void&nbsp;setHttpClient(org.apache.http.impl.client.CloseableHttpClient&nbsp;httpClient,
                             boolean&nbsp;replace)</pre>
<div class="block">Set the HTTP client instance that should be used for all requests. This instance will be
 returned by <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getHttpClient--"><code>getHttpClient()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>httpClient</code> - the HTTP client to set. Can be null, to reset the client.</dd>
<dd><code>replace</code> - if true the current HTTP client instance will be closed and replaced with the new
            one. If false and there is a current HTTP client the current one is not updated.</dd>
</dl>
</li>
</ul>
<a name="setProvideDefaultImageIfDisabled-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setProvideDefaultImageIfDisabled</h4>
<pre>public&nbsp;void&nbsp;setProvideDefaultImageIfDisabled(boolean&nbsp;provideDefaultImageIfDisabled)</pre>
<div class="block">Set whether the default image can be returned even if the provider is temporarily disabled.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>provideDefaultImageIfDisabled</code> - true to return the default image</dd>
</dl>
</li>
</ul>
<a name="validateContentType-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validateContentType</h4>
<pre>protected&nbsp;void&nbsp;validateContentType(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;contentType)
                            throws <a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a></pre>
<div class="block">Validate that the content type of the response is an image mime type.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>contentType</code> - the content type</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a></code> - in case the content type is not an image/* mime type. This exception will lead to
             temporarily disabling the provider.</dd>
</dl>
</li>
</ul>
<a name="validateStatusCode-org.apache.http.StatusLine-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>validateStatusCode</h4>
<pre>protected&nbsp;void&nbsp;validateStatusCode(org.apache.http.StatusLine&nbsp;statusLine)
                           throws <a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a>,
                                  <a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a></pre>
<div class="block">Checks the status code of a response for an image request.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>statusLine</code> - the status line containing the status code</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../com/communote/server/api/core/image/ImageNotFoundException.html" title="class in com.communote.server.api.core.image">ImageNotFoundException</a></code> - in case the status code is one of the codes in
             <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getNotDisablingStatusCodes--"><code>getNotDisablingStatusCodes()</code></a></dd>
<dd><code><a href="../../../../../com/communote/server/core/image/exceptions/ExternalImageProviderServiceException.html" title="class in com.communote.server.core.image.exceptions">ExternalImageProviderServiceException</a></code> - in case the status code is not 200 and not one of the codes returned by
             <a href="../../../../../com/communote/server/core/image/HttpExternalImageProvider.html#getNotDisablingStatusCodes--"><code>getNotDisablingStatusCodes()</code></a>. The image provider will be disabled
             temporarily.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/HttpExternalImageProvider.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/communote/server/core/image/FileSystemCachingImageManager.html" title="class in com.communote.server.core.image"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/communote/server/core/image/ImageProviderManager.html" title="class in com.communote.server.core.image"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/communote/server/core/image/HttpExternalImageProvider.html" target="_top">Frames</a></li>
<li><a href="HttpExternalImageProvider.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2019 <a href="https://communote.github.io/">Communote team</a>. All rights reserved.</small></p>
</body>
</html>
